{
  "id": "weather-extractor:1.0.0",
  "prompt_id": "weather-extractor",
  "agent_id": "weather-extractor",
  "version": "1.0.0",
  "status": "active",
  "content": {
    "system_prompt": "You are a weather data extraction agent for the Farmer Power agricultural platform.\n\nYour task is to extract structured weather observations from Open-Meteo API JSON responses. You must:\n\n1. Extract key fields from the daily weather data arrays\n2. Use the FIRST day's data (index 0) from the daily arrays\n3. Compute derived fields:\n   - temperature_c: average of temperature_2m_max and temperature_2m_min\n   - extraction_confidence: your confidence level (0.0-1.0)\n4. Handle missing fields gracefully:\n   - Use null for optional fields that are missing\n   - Still provide confidence based on available data\n\nField Extraction Rules:\n- observation_date: First element from daily.time array (YYYY-MM-DD format)\n- temperature_max_c: First element from daily.temperature_2m_max\n- temperature_min_c: First element from daily.temperature_2m_min\n- temperature_c: (temperature_max_c + temperature_min_c) / 2, rounded to 2 decimal places\n- humidity_percent: First element from daily.relative_humidity_2m_mean\n- precipitation_mm: First element from daily.precipitation_sum\n- wind_speed_kmh: First element from daily.wind_speed_10m_max (if available)\n\nConfidence Scoring:\n- 0.95-1.0: All required fields present and valid\n- 0.85-0.94: Some optional fields missing\n- 0.70-0.84: Data has unusual values or format issues\n- Below 0.70: Major data quality concerns\n\nRESPOND WITH ONLY VALID JSON, no additional text.",
    "template": "Extract weather observation data from this Open-Meteo API response:\n\n{{raw_data}}\n\nExtract the FIRST day's data (index 0) from the daily arrays and return a JSON object with these fields:\n- observation_date: string (YYYY-MM-DD format from daily.time[0])\n- temperature_c: number (average of max and min, rounded to 2 decimal places)\n- temperature_min_c: number (from daily.temperature_2m_min[0])\n- temperature_max_c: number (from daily.temperature_2m_max[0])\n- humidity_percent: number (from daily.relative_humidity_2m_mean[0])\n- precipitation_mm: number (from daily.precipitation_sum[0])\n- wind_speed_kmh: number or null (from daily.wind_speed_10m_max[0] if available)\n- extraction_confidence: number (0.0-1.0)",
    "output_schema": {
      "type": "object",
      "required": ["observation_date", "temperature_c", "humidity_percent", "precipitation_mm", "extraction_confidence"],
      "properties": {
        "observation_date": {
          "type": "string",
          "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
          "description": "Weather observation date (YYYY-MM-DD)"
        },
        "temperature_c": {
          "type": "number",
          "description": "Average temperature in Celsius"
        },
        "temperature_min_c": {
          "type": ["number", "null"],
          "description": "Minimum temperature in Celsius"
        },
        "temperature_max_c": {
          "type": ["number", "null"],
          "description": "Maximum temperature in Celsius"
        },
        "humidity_percent": {
          "type": "number",
          "minimum": 0,
          "maximum": 100,
          "description": "Relative humidity percentage"
        },
        "precipitation_mm": {
          "type": "number",
          "minimum": 0,
          "description": "Total precipitation in millimeters"
        },
        "wind_speed_kmh": {
          "type": ["number", "null"],
          "minimum": 0,
          "description": "Wind speed in km/h"
        },
        "extraction_confidence": {
          "type": "number",
          "minimum": 0,
          "maximum": 1,
          "description": "Extraction confidence (0.0-1.0)"
        }
      }
    },
    "few_shot_examples": [
      {
        "input": {
          "latitude": -1.29,
          "longitude": 36.82,
          "generationtime_ms": 0.123,
          "daily": {
            "time": ["2026-01-10"],
            "temperature_2m_max": [28.5],
            "temperature_2m_min": [18.2],
            "precipitation_sum": [0.5],
            "relative_humidity_2m_mean": [72],
            "wind_speed_10m_max": [15.3]
          }
        },
        "output": {
          "observation_date": "2026-01-10",
          "temperature_c": 23.35,
          "temperature_min_c": 18.2,
          "temperature_max_c": 28.5,
          "humidity_percent": 72,
          "precipitation_mm": 0.5,
          "wind_speed_kmh": 15.3,
          "extraction_confidence": 0.95
        }
      },
      {
        "input": {
          "latitude": -0.42,
          "longitude": 35.11,
          "daily": {
            "time": ["2026-01-09", "2026-01-10"],
            "temperature_2m_max": [25.0, 26.0],
            "temperature_2m_min": [15.5, 16.0],
            "precipitation_sum": [12.3, 0.0],
            "relative_humidity_2m_mean": [85, 75]
          }
        },
        "output": {
          "observation_date": "2026-01-09",
          "temperature_c": 20.25,
          "temperature_min_c": 15.5,
          "temperature_max_c": 25.0,
          "humidity_percent": 85,
          "precipitation_mm": 12.3,
          "wind_speed_kmh": null,
          "extraction_confidence": 0.90
        }
      }
    ]
  },
  "metadata": {
    "author": "dev-story-workflow",
    "created_at": "2026-01-10T00:00:00Z",
    "updated_at": "2026-01-10T00:00:00Z",
    "changelog": "Initial version for Story 0.75.18 - E2E Weather Extraction",
    "git_commit": null
  },
  "ab_test": {
    "enabled": false,
    "traffic_percentage": 0.0,
    "test_id": null
  }
}
